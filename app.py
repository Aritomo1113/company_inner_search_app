import streamlit as st
import initialize
import constants as ct

# ------------------------------------------
# ãƒšãƒ¼ã‚¸åŸºæœ¬è¨­å®š
# ------------------------------------------
st.set_page_config(page_title=ct.APP_NAME, layout="wide")

# ------------------------------------------
# åˆæœŸåŒ–å‡¦ç†
# ------------------------------------------
initialize.initialize()

# ------------------------------------------
# ã‚«ã‚¹ã‚¿ãƒ CSS
# ------------------------------------------
st.markdown(
    """
    <style>
    .stSidebar {
        padding-top: 20px;
    }
    .main-container {
        padding-top: 30px;
        padding-bottom: 60px;
    }
    .chat-input-fake {
        opacity: 0.9;
        border-radius: 8px;
        padding: 12px 16px;
        background: #f5f5f7;
        color: #6b6b6b;
    }
    </style>
    """,
    unsafe_allow_html=True,
)

# ------------------------------------------
# ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆãƒ¡ã‚¤ãƒ³ï¼‰
# ------------------------------------------
left_col, mid_col, right_col = st.columns([1, 6, 1])
with mid_col:
    st.title(ct.APP_NAME)

# ------------------------------------------
# ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼ˆåˆ©ç”¨ç›®çš„ï¼‰
# ------------------------------------------
with st.sidebar:
    st.header("åˆ©ç”¨ç›®çš„")
    answer_mode = st.radio(
        "",
        (ct.ANSWER_MODE_1, ct.ANSWER_MODE_2),
        index=0,
    )

    st.markdown("---")

    # --- å…±é€šèª¬æ˜ï¼ˆç°¡æ½”ã«çµ±ä¸€ï¼‰ ---
    if answer_mode == ct.ANSWER_MODE_1:
        st.markdown("ğŸ” **ç¤¾å†…æ–‡æ›¸æ¤œç´¢**ï¼šå…¥åŠ›å†…å®¹ã«é–¢é€£ã™ã‚‹æ–‡æ›¸ã‚’æ¤œç´¢ã—ã¾ã™ã€‚")
        st.caption("ä¾‹ï¼šç¤¾å†…ã®å ±å‘Šæ›¸ä½œæˆãƒ«ãƒ¼ãƒ«ã‚’ç´¹ä»‹ã—ã¦ã„ã‚‹æ–‡æ›¸")
    else:
        st.markdown("ğŸ’¬ **ç¤¾å†…å•ã„åˆã‚ã›**ï¼šç¤¾å†…æƒ…å ±ã‚’ã‚‚ã¨ã«è³ªå•ã¸å›ç­”ã—ã¾ã™ã€‚")
        st.caption("ä¾‹ï¼šäººäº‹éƒ¨ã«é–¢ã—ã¦è©³ã—ã„å¾“æ¥­å“¡æƒ…å ±ã‚’ä¸€è¦§åŒ–ã—ã¦")

# ------------------------------------------
# ãƒ¡ã‚¤ãƒ³ã‚¨ãƒªã‚¢ï¼ˆèª¬æ˜ãƒœãƒƒã‚¯ã‚¹ãƒ»ãƒãƒ£ãƒƒãƒˆæ¬„ï¼‰
# ------------------------------------------
with mid_col:
    st.markdown("")  # spacer

    # é»„è‰²ãƒœãƒƒã‚¯ã‚¹ï¼ˆçµ±åˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰
    st.warning(
        "ã“ã‚“ã«ã¡ã¯ã€‚ç§ã¯ç¤¾å†…æ–‡æ›¸ã®æƒ…å ±ã‚’ã‚‚ã¨ã«å›ç­”ã™ã‚‹ç”ŸæˆAIãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã§ã™ã€‚\n"
        "ã‚µã‚¤ãƒ‰ãƒãƒ¼ã§åˆ©ç”¨ç›®çš„ã‚’é¸æŠã—ã€ç”»é¢ä¸‹éƒ¨ã®ãƒãƒ£ãƒƒãƒˆæ¬„ã‹ã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã¦ãã ã•ã„ã€‚\n\n"
        "ğŸ’¡ **è³ªå•ã‚„æ¤œç´¢å†…å®¹ã¯ã€å…·ä½“çš„ã«å…¥åŠ›ã—ãŸæ–¹ãŒé–¢é€£è³‡æ–™ã®ç²¾åº¦ã‚’é«˜ã‚ã‚„ã™ã„ã§ã™ã€‚**"
    )

    st.markdown("")  # ä½™ç™½

    # ãƒãƒ£ãƒƒãƒˆå…¥åŠ›æ¬„
    user_input = st.chat_input(ct.CHAT_INPUT_HELPER_TEXT)

    # ãƒ‡ãƒãƒƒã‚°è¡¨ç¤ºï¼ˆå®Ÿé‹ç”¨ã§ã¯LLMã«ç½®æ›ï¼‰
    if user_input:
        with st.spinner(ct.SPINNER_TEXT):
            st.markdown("**ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›:**")
            st.write(user_input)
            st.markdown("---")
            st.info("ï¼ˆã“ã“ã« LLM ã®è¿”ç­”ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼‰")